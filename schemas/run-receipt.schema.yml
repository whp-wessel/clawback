# schemas/run-receipt.schema.yml â€” JSON Schema for run receipts
$schema: https://json-schema.org/draft/2020-12/schema
title: ClawBack Run Receipt
description: Schema for reproducibility receipts in /runs/

type: object
required:
  - task_id
  - timestamp
  - commit_sha
  - environment
  - inputs
  - outputs

properties:
  task_id:
    type: string
    description: ID of the task this run executed

  timestamp:
    type: string
    format: date-time

  commit_sha:
    type: string
    pattern: "^[0-9a-f]{40}$"
    description: Full git commit SHA at time of run

  environment:
    type: object
    required: [runtime, dependencies_lock]
    properties:
      runtime:
        type: string
        description: "e.g., python:3.12.1, R:4.3.2"
      dependencies_lock:
        type: string
        description: "Path to lock file (requirements.txt, renv.lock)"
      os:
        type: string
      extra:
        type: object

  inputs:
    type: array
    items:
      type: object
      required: [path, sha256]
      properties:
        path:
          type: string
        sha256:
          type: string
          pattern: "^[0-9a-f]{64}$"
        size_bytes:
          type: integer

  outputs:
    type: array
    items:
      type: object
      required: [artifact_id, sha256]
      properties:
        artifact_id:
          type: string
        sha256:
          type: string
          pattern: "^[0-9a-f]{64}$"
        size_bytes:
          type: integer

  duration_seconds:
    type: number

  agent_id:
    type: string
    description: Identifier of the agent that executed this run

additionalProperties: false
